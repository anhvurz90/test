<?xml version="1.0" encoding="UTF-8" ?>
<Module>
  <ModulePrefs title="CourzeCorner">
    <Require feature="rpc"/>
    <Require feature="views"/>
  </ModulePrefs>
  <Content type="html">
    <![CDATA[
      <script src="//plus.google.com/hangouts/_/api/v1/hangout.js"></script>
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
      <!-- Your application code -->
      <script>
	 console.log("CourzeCorner!!!");
	 gapi.hangout.onApiReady.add(function(eventObj) {
	 	 console.log(gapi.hangout.getHangoutUrl());		 

		urlParam = function(name){
			var results = new RegExp('[\?&]' + name + '=([^&#]*)').exec(window.location.href);
			return results[1] || 0;
		}

		 $.ajax({
			url: "https://localhost:8080/api/hangout",
			type: "GET",
			data: {url:gapi.hangout.getHangoutUrl(),
			          targetUserId: urlParam("targetUserId")},
			async: true,
			crossOrigin: true
		}).done(function(data) {
			console.log("Sent hangout url to server");
		});
	});

      </script>
    ]]>
  </Content>
</Module>